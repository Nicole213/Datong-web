<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>盘点作业</title>
    <link rel="stylesheet" href="../styles/pages.css">
    <link rel="stylesheet" href="../styles/inventory-operation.css">
</head>
<body>
    <div class="page-container">
        <div class="page-header">
            <h1>盘点作业</h1>
            <div class="port-badge" id="portBadge">出库口 1</div>
        </div>

        <!-- 扫描容器区域 -->
        <div class="scan-container-section" id="scanContainerSection">
            <div class="section-header">
                <h2>扫描容器</h2>
            </div>
            
            <!-- 盘点计划信息 -->
            <div class="info-card">
                <div class="card-title">当前盘点计划</div>
                <div class="plan-info-grid">
                    <div class="info-item">
                        <label>计划号：</label>
                        <span id="planNo">PD-2024-002</span>
                    </div>
                    <div class="info-item">
                        <label>盘点范围：</label>
                        <span id="planScope">指定库区</span>
                    </div>
                    <div class="info-item">
                        <label>负责人：</label>
                        <span id="planOwner">李四</span>
                    </div>
                </div>
            </div>

            <div class="info-card">
                <div class="card-title">扫描容器编码</div>
                <div class="scan-container-area">
                    <div class="scan-input-group">
                        <label>容器编码：</label>
                        <input type="text" class="scan-input" id="scanContainerCode" placeholder="请扫描容器编码" autocomplete="off">
                    </div>
                    <button class="scan-container-btn" id="scanContainerBtn">扫描容器</button>
                </div>
                <div class="help-text">请使用PDA扫描到达盘点口的容器编码</div>
            </div>
        </div>

        <!-- 当前盘点信息（扫码后显示） -->
        <div class="current-inventory-section" id="currentInventorySection" style="display: none;">
            <div class="section-header">
                <h2>当前盘点信息</h2>
            </div>
            
            <!-- 盘点计划信息 -->
            <div class="info-card">
                <div class="card-title">当前盘点计划</div>
                <div class="plan-info-grid">
                    <div class="info-item">
                        <label>计划号：</label>
                        <span id="currentPlanNo">PD-2024-002</span>
                    </div>
                    <div class="info-item">
                        <label>盘点范围：</label>
                        <span id="currentPlanScope">指定库区</span>
                    </div>
                    <div class="info-item">
                        <label>负责人：</label>
                        <span id="currentPlanOwner">李四</span>
                    </div>
                </div>
            </div>

            <!-- 容器信息 -->
            <div class="info-card">
                <div class="card-title-with-action">
                    <div class="card-title">当前容器信息</div>
                    <button class="scan-new-container-btn" id="scanNewContainerBtn">扫描容器</button>
                </div>
                <div class="info-item" style="margin-bottom: 12px;">
                    <label>容器编码：</label>
                    <span id="currentContainerCode" class="highlight-text">-</span>
                </div>
                <div class="info-item" style="margin-bottom: 12px;">
                    <label>容器类型：</label>
                    <span id="currentContainerType">-</span>
                </div>
                <div class="info-item" style="margin-bottom: 16px;">
                    <label>所在库位：</label>
                    <span id="currentContainerLocation">-</span>
                </div>
                <div class="scan-area">
                    <div class="scan-input-group">
                        <label>扫描物料编码：</label>
                        <input type="text" class="scan-input" id="scanMaterialCode" placeholder="请扫描物料编码" autocomplete="off">
                    </div>
                    <button class="scan-material-btn" id="scanMaterialBtn">扫描物料码</button>
                </div>
            </div>

            <!-- 容器物料明细 -->
            <div class="info-card">
                <div class="card-title-with-action">
                    <div class="card-title">容器物料明细</div>
                    <button class="add-material-btn" id="addMaterialBtn">➕ 添加物料</button>
                </div>
                <table class="mini-table">
                    <thead>
                        <tr>
                            <th width="100">物料编码</th>
                            <th width="120">物料名称</th>
                            <th width="60">图片</th>
                            <th width="80">是否盘点</th>
                            <th width="80">账面数量</th>
                            <th width="100">盘点数量</th>
                            <th width="80">盘点差异</th>
                            <th width="100">盘点结果</th>
                        </tr>
                    </thead>
                    <tbody id="materialTableBody">
                        <!-- 物料明细将通过JavaScript动态生成 -->
                    </tbody>
                </table>
            </div>

            <!-- 操作按钮 -->
            <div class="info-card">
                <div class="action-buttons">
                    <button class="primary-btn" id="completeInventoryBtn">完成盘点</button>
                    <button class="secondary-btn" id="cancelBtn">取消</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 确认入库库位弹窗 -->
    <div class="modal" id="confirmLocationModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>确认入库库位</h3>
                <span class="modal-close" id="locationModalClose">&times;</span>
            </div>
            <div class="modal-body">
                <div class="success-info">
                    <div class="success-icon">✓</div>
                    <div class="success-text">盘点完成！</div>
                </div>
                <div class="container-info">
                    <div class="info-item">
                        <label>容器编码：</label>
                        <span id="modalContainerCode">-</span>
                    </div>
                    <div class="info-item">
                        <label>容器类型：</label>
                        <span id="modalContainerType">-</span>
                    </div>
                </div>
                <div class="form-group">
                    <label class="required">选择入库库位：</label>
                    <select class="form-input" id="modalLocationSelect">
                        <option value="">请选择库位</option>
                        <option value="1-5-12-1">1-5-12-1（推荐）</option>
                        <option value="1-6-12-1">1-6-12-1</option>
                        <option value="2-5-12-1">2-5-12-1</option>
                        <option value="2-6-12-1">2-6-12-1</option>
                    </select>
                    <div class="help-text">系统已自动推荐适配该容器的空库位</div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn primary" id="confirmLocationBtn">确认入库</button>
                <button class="modal-btn secondary" id="cancelLocationBtn">取消</button>
            </div>
        </div>
    </div>

    <script src="../scripts/inventory-operation.js"></script>
</body>
</html>
