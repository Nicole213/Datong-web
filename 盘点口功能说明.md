# 盘点口功能说明

## 功能概述
盘点计划详情中的"盘点口"字段根据计划状态显示不同内容。

## 显示规则

### 显示盘点口信息的状态
以下状态会显示盘点口信息：
- **执行中** (processing)：显示盘点口 + 显示"修改"按钮
- **已完成** (completed)：显示盘点口（只读，无修改按钮）
- **已暂停** (paused)：显示盘点口 + 显示"修改"按钮
- **已终止** (terminated)：显示盘点口（只读，无修改按钮）

### 显示为空的状态
以下状态盘点口字段显示为"-"：
- **待执行** (pending)：显示"-"（还未开始盘点）
- **已取消** (cancelled)：显示"-"（计划已取消）

## 修改盘点口功能

### 修改入口
- 仅在"执行中"或"已暂停"状态显示"修改"按钮
- 点击"修改"按钮打开修改盘点口弹窗

### 修改规则
1. 已经开始执行的盘点任务继续在原盘点口执行
2. 后续未开始执行的任务将使用新盘点口
3. 容器将被送至新设置的盘点口

## 实现位置

### 代码文件
- `scripts/inventory-plan.js` - viewDetail() 函数
- `pages/盘点计划.html` - 详情弹窗基本信息部分
- `styles/inventory-plan.css` - 修改按钮样式

### 关键代码逻辑
```javascript
// 执行中/已完成/已暂停/已终止状态显示盘点口
const showPortStatuses = ['processing', 'completed', 'paused', 'terminated'];

if (showPortStatuses.includes(plan.status) && plan.inventoryPort) {
    portSpan.textContent = plan.inventoryPort;
    // 执行中或已暂停状态可以修改盘点口
    if (plan.status === 'processing' || plan.status === 'paused') {
        editPortBtn.style.display = 'inline-block';
    } else {
        editPortBtn.style.display = 'none';
    }
} else {
    // 待执行/已取消状态显示为空
    portSpan.textContent = '-';
    editPortBtn.style.display = 'none';
}
```

## 测试场景

### 场景1：待执行状态
- 查看PD-2024-003或PD-2024-004详情
- 盘点口字段应显示"-"
- 无修改按钮

### 场景2：执行中状态
- 点击"开始盘点"，选择盘点口（如"出库口1"）
- 查看详情，盘点口字段应显示"出库口1"
- 显示"修改"按钮
- 点击修改可以更换盘点口

### 场景3：已暂停状态
- 暂停执行中的计划
- 查看详情，盘点口字段应显示原盘点口
- 显示"修改"按钮

### 场景4：已完成/已终止状态
- 查看已完成或已终止的计划详情
- 盘点口字段应显示盘点口信息
- 不显示"修改"按钮（只读）

### 场景5：已取消状态
- 取消待执行的计划
- 查看详情，盘点口字段应显示"-"
- 无修改按钮

## 功能状态
✅ 已实现并测试通过
