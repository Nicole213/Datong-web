# 入库作业功能说明

## 功能概述

入库作业是一个操作终端页面，用于实际的入库组盘操作。操作员在入库口使用该页面进行物料扫描、组盘和入库操作。

## 页面结构

### 1. 入库口标识
- **位置：** 页面右上角
- **显示：** 固定显示当前操作终端所属入库口（如"入库口 1"）
- **特点：** 不可手动修改，由系统配置决定

### 2. 当前组盘信息

#### 2.1 入库单信息
显示当前执行的入库单信息：
- **入库单号：** 当前正在处理的入库单编号
- **计划数量：** 该入库单的总计划数量
- **已入库数量：** 已完成入库的数量
- **待入库数量：** 还需要入库的数量

#### 2.2 当前容器信息
显示当前到入库口的容器信息：
- **容器编码：** 当前正在组盘的容器编号
- **推荐存储物料：** 系统推荐存储的物料信息
- **推荐存储数量：** 系统推荐的存储数量

#### 2.3 实际存储信息
操作员输入实际存储的物料信息：
- **扫描物料编码：** 扫描枪扫描物料条码，自动填充
- **实际入库数量：** 手动输入实际入库的数量
- **物料信息回显：** 扫描后自动显示物料编码、名称和数量

#### 2.4 操作按钮
- **标记满托：** 复选框，若该托盘是满托时手动标记
- **确认组盘：** 确认将物料和托盘进行绑定
- **取消组盘：** 清除实际存储物料信息，可重新扫码

### 3. 待组盘列表

显示该入库单在该入库口后面待组盘的容器列表：
- **容器编码：** 容器的唯一编号
- **当前存储物料明细：** 容器当前已存储的物料信息
- **推荐存储物料：** 系统推荐存储的物料
- **推荐存储数量：** 系统推荐的数量
- **状态：** 待组盘、组盘中、已完成

当前正在处理的托盘会高亮显示。

## 操作流程

### 流程1：正常组盘流程

```
1. 系统自动加载第一个待组盘的容器
   ↓
2. 显示容器信息和推荐存储物料
   ↓
3. 操作员使用扫描枪扫描物料条码
   ↓
4. 系统验证物料是否属于当前入库单
   ↓
5. 系统显示物料信息（编码、名称）
   ↓
6. 操作员输入实际入库数量
   ↓
7. （可选）勾选"标记满托"
   ↓
8. 点击"确认组盘"按钮
   ↓
9. 系统验证数据有效性
   ↓
10. 弹出"选择入库库位"弹窗
   ↓
11. 系统自动推荐适配该容器的空库位
   ↓
12. 操作员选择或修改库位
   ↓
13. 点击"确认入库"按钮
   ↓
14. 系统完成入库，更新数据
   ↓
15. 自动加载下一个待组盘的容器
```

### 流程2：取消组盘流程

```
1. 操作员扫描了错误的物料
   ↓
2. 点击"取消组盘"按钮
   ↓
3. 系统清除实际存储物料信息
   ↓
4. 操作员可以重新扫描正确的物料
```

## 数据验证

### 1. 物料扫描验证
- ✅ 物料编码必须存在
- ✅ 物料必须属于当前入库单
- ❌ 不属于当前入库单的物料会提示错误

### 2. 数量验证
- ✅ 数量必须大于0
- ✅ 数量不能超过该物料的待入库数量
- ❌ 超过待入库数量会提示错误

### 3. 组盘验证
- ✅ 必须已扫描物料
- ✅ 必须已输入数量
- ❌ 未扫描物料或未输入数量会提示错误

### 4. 库位验证
- ✅ 必须选择入库库位
- ✅ 库位必须是空库位
- ✅ 库位必须适配该容器类型

## 界面特点

### 1. 信息卡片设计
- 使用卡片式布局，信息层次清晰
- 不同类型的信息用不同颜色区分
- 实际存储信息用绿色背景突出显示

### 2. 扫描输入优化
- 扫描框自动获取焦点
- 扫描后自动显示物料信息
- 输入框大字体，便于查看

### 3. 状态可视化
- 当前处理的托盘在列表中高亮显示
- 不同状态用不同颜色的标签区分
- 入库口标识用渐变色突出显示

### 4. 操作反馈
- 每个操作都有明确的提示信息
- 成功操作显示绿色提示
- 错误操作显示红色提示

## 测试数据

### 入库单：RK-2024-0003
- **物料1：** WL-2024-001 - 电子元件A型 (计划80)
- **物料2：** WL-2024-003 - 塑料配件C型 (计划60)
- **物料3：** WL-2024-005 - 金属材料E型 (计划40)

### 待组盘容器
1. **RK-2024-001**
   - 当前存储：电子元件A型 × 30
   - 推荐物料：WL-2024-001 - 电子元件A型
   - 推荐数量：20

2. **RK-2024-002**
   - 当前存储：空托盘
   - 推荐物料：WL-2024-003 - 塑料配件C型
   - 推荐数量：50

3. **RK-2024-003**
   - 当前存储：机械零件B型 × 15、塑料配件C型 × 10
   - 推荐物料：WL-2024-005 - 金属材料E型
   - 推荐数量：25

### 可用库位
- 1-5-12-1 (库区A)
- 1-6-12-1 (库区A)
- 1-7-12-1 (库区A)
- 2-5-12-1 (库区B)
- 2-6-12-1 (库区B)

## 测试步骤

### 测试场景1：正常组盘流程

1. 打开 `pages/index.html`
2. 点击"入库管理" → "入库作业"
3. 查看当前容器信息（RK-2024-001）
4. 在"扫描物料编码"框输入：`WL-2024-001`
5. 查看物料信息是否正确显示
6. 在"实际入库数量"框输入：`20`
7. 点击"确认组盘"按钮
8. 查看是否弹出"选择入库库位"弹窗
9. 选择库位：`1-5-12-1`
10. 点击"确认入库"按钮
11. 查看是否成功入库并自动加载下一个容器

### 测试场景2：扫描错误物料

1. 在"扫描物料编码"框输入：`WL-9999-999`（不存在的物料）
2. 查看是否提示"物料编码不存在或不属于当前入库单！"

### 测试场景3：数量超限

1. 扫描物料：`WL-2024-001`
2. 输入数量：`999`（超过待入库数量）
3. 点击"确认组盘"
4. 查看是否提示"入库数量不能超过待入库数量"

### 测试场景4：取消组盘

1. 扫描物料：`WL-2024-001`
2. 输入数量：`20`
3. 点击"取消组盘"按钮
4. 确认取消
5. 查看实际存储信息是否已清空

### 测试场景5：标记满托

1. 扫描物料：`WL-2024-003`
2. 输入数量：`50`
3. 勾选"标记满托"复选框
4. 点击"确认组盘"
5. 完成入库
6. 查看满托标记是否生效

## 相关文件

- **HTML：** `pages/入库作业.html` - 页面结构
- **CSS：** `styles/inbound-operation.css` - 页面样式
- **JavaScript：** `scripts/inbound-operation.js` - 业务逻辑
- **菜单配置：** `pages/index.html` - 添加了"入库作业"菜单项

## 技术特点

### 1. 自动化流程
- 自动加载待组盘容器
- 自动推荐库位
- 自动更新数据

### 2. 扫描枪支持
- 支持条码扫描枪输入
- 扫描后自动验证和回显

### 3. 实时验证
- 输入时实时验证数据
- 提前发现错误，避免无效操作

### 4. 友好提示
- 每个操作都有明确的提示
- 错误信息清晰易懂

## 后续优化建议

1. **扫描音效：** 扫描成功/失败时播放不同音效
2. **快捷键支持：** 支持键盘快捷键操作
3. **历史记录：** 显示最近的组盘记录
4. **打印功能：** 打印入库标签
5. **多语言支持：** 支持中英文切换

## 状态

✅ **已完成** - 入库作业页面已创建并添加到菜单
