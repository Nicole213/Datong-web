# 清空库存功能测试说明

## 功能概述

在库位地图页面中，点击有货库位后，【清空库存】按钮变为可点击状态。点击后弹出确认弹窗，确认后可成功清空该库位内的所有物料库存信息，库位状态变为空托。

## 功能特点

### 【清空库存】按钮
- **触发条件**：只有选中有货库位时才可点击
- **按钮状态**：
  - 未选中库位：禁用状态（灰色，不可点击）
  - 选中空库位：禁用状态（灰色，不可点击）
  - 选中空托库位：禁用状态（灰色，不可点击）
  - 选中有货库位：启用状态（正常颜色，可点击）

### 清空库存确认弹窗
- **弹窗标题**：⚠️ 清空库存确认
- **显示信息**：
  - 库位编码
  - 库位名称
  - 容器编码
  - 物料数量统计
- **警告提示**：操作不可撤销的警告信息
- **操作按钮**：取消、确认清空

## 操作流程

### 1. 选择有货库位
1. 在库位地图中找到有货库位（黄色背景，显示"有货"）
2. 点击该库位进行选中
3. 观察【清空库存】按钮变为可点击状态

### 2. 打开确认弹窗
1. 点击【清空库存】按钮
2. 弹出清空库存确认弹窗
3. 查看库位信息和物料统计

### 3. 确认清空操作
1. 仔细阅读警告信息
2. 点击【确认清空】按钮
3. 系统执行清空操作

### 4. 查看结果
1. 显示"库存清空成功！该库位已变为空托状态。"提示
2. 弹窗自动关闭
3. 库位状态从"有货"变为"空托"
4. 库位背景色从黄色变为浅蓝色

## 状态变化

### 清空前（有货库位）
- **背景色**：黄色（#fffde7）
- **状态文字**：有货
- **CSS类**：occupied
- **物料数据**：包含物料列表
- **容器**：保留容器编码

### 清空后（空托库位）
- **背景色**：浅蓝色（#e1f5fe）
- **状态文字**：空托
- **CSS类**：empty-pallet
- **物料数据**：清空（空数组）
- **容器**：保留容器编码

## 测试用例

### 测试用例 1：按钮状态验证

**测试步骤：**
1. 打开库位地图页面
2. 不选择任何库位，观察【清空库存】按钮状态
3. 点击空库位（绿色），观察按钮状态
4. 点击空托库位（浅蓝色），观察按钮状态
5. 点击有货库位（黄色），观察按钮状态

**预期结果：**
- ✅ 未选中时：按钮禁用
- ✅ 选中空库位时：按钮禁用
- ✅ 选中空托库位时：按钮禁用
- ✅ 选中有货库位时：按钮启用

### 测试用例 2：确认弹窗显示

**测试步骤：**
1. 选中一个有货库位
2. 点击【清空库存】按钮
3. 查看确认弹窗内容

**预期结果：**
- ✅ 弹窗正确显示
- ✅ 库位编码正确显示
- ✅ 库位名称正确显示
- ✅ 容器编码正确显示
- ✅ 物料数量统计正确
- ✅ 警告信息清晰显示

### 测试用例 3：取消操作

**测试步骤：**
1. 打开清空库存确认弹窗
2. 点击【取消】按钮
3. 观察库位状态

**预期结果：**
- ✅ 弹窗关闭
- ✅ 库位状态不变
- ✅ 物料数据不变

### 测试用例 4：确认清空操作

**测试步骤：**
1. 选中一个有货库位，记录其状态
2. 打开清空库存确认弹窗
3. 点击【确认清空】按钮
4. 观察库位状态变化

**预期结果：**
- ✅ 显示成功提示："库存清空成功！该库位已变为空托状态。"
- ✅ 弹窗自动关闭
- ✅ 库位背景从黄色变为浅蓝色
- ✅ 状态文字从"有货"变为"空托"
- ✅ 【清空库存】按钮变为禁用状态
- ✅ 容器编码保持不变
- ✅ 不显示任何错误提示

### 测试用例 5：多次操作验证

**测试步骤：**
1. 清空一个有货库位
2. 选择另一个有货库位
3. 再次执行清空操作
4. 验证功能稳定性

**预期结果：**
- ✅ 每次操作都正常
- ✅ 状态更新正确
- ✅ 按钮状态正确切换

## 弹窗样式说明

### 确认弹窗特点
- **尺寸**：小型弹窗（max-width: 500px）
- **图标**：🗑️ 垃圾桶图标
- **颜色方案**：
  - 确认按钮：红色（#ff4d4f）
  - 取消按钮：灰色
  - 警告区域：橙色背景

### 信息展示区域
- **库位信息**：灰色背景区域显示
- **警告信息**：橙色背景区域显示
- **操作提示**：明确说明操作不可撤销

## 控制台日志

### 操作日志示例
```javascript
// 打开确认弹窗
"打开清空库存确认弹窗：1-1-12-1"

// 开始清空操作
{
  location: "1-1-12-1",
  container: "TP-001",
  materialsCount: 3
}

// 状态更新
{
  location: "1-1-12-1",
  oldStatus: "occupied",
  newStatus: "empty-pallet",
  container: "TP-001",
  materialsCleared: true
}

// 操作完成
"清空库存操作完成"
```

## 注意事项

### 1. 安全性
- 只有有货库位才能执行清空操作
- 需要二次确认，防止误操作
- 明确的警告提示

### 2. 数据完整性
- 清空物料数据但保留容器信息
- 正确更新库位状态
- 实时更新按钮状态

### 3. 用户体验
- 清晰的状态反馈
- 直观的视觉变化
- 详细的操作日志

## 测试完成标准

- ✅ 按钮状态根据库位类型正确切换
- ✅ 确认弹窗正确显示库位信息
- ✅ 取消操作不影响库位状态
- ✅ 确认清空后库位状态正确更新
- ✅ 库位背景色和文字正确变化
- ✅ 容器编码得到保留
- ✅ 物料数据完全清空
- ✅ 控制台日志完整输出
- ✅ 可以连续操作多个库位

---

**测试时间**：约 5 分钟  
**测试重点**：确认清空库存功能能正确将有货库位变为空托库位，保留容器但清空所有物料